<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solmemetics</title>
  <style>
    html {
      scroll-behavior: smooth; /* Smooth scrolling for in-page links */
    }

    body {
      background: linear-gradient(180deg, #000000, #1a1a1a); /* Subtle gradient background */
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      position: relative;
      min-height: 100vh; /* Ensure body takes full viewport height */
      display: flex;
      flex-direction: column;
      justify-content: center; /* Center content vertically */
      align-items: center; /* Center content horizontally */
      margin: 0;
      padding: 20px; /* Reduced padding to avoid excessive spacing */
    }

    .content {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: -100px; /* Adjust to shift content slightly higher for balance */
      animation: fadeIn 1s ease-in; /* Fade-in animation for content */
    }

    @keyframes fadeIn {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }

    img {
      max-width: 300px;
      height: auto;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 40px;
    }

    /* Style for the Connect button */
    .connect-button {
      padding: 12px 24px;
      font-size: 16px;
      background: white;
      color: black;
      border: none;
      border-radius: 9999px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .connect-button:hover {
      background-color: #e0e0e0;
    }

    /* Style for Home and Whitepaper buttons */
    .nav-button {
      font-size: 16px;
      color: white;
      font-weight: bold;
      background: none;
      border: none;
      cursor: pointer;
      transition: color 0.3s;
    }

    .nav-button:hover {
      color: #cccccc; /* Subtle greyish-white on hover */
    }

    #status {
      margin-top: 20px;
      font-size: 16px;
      color: #ccc;
    }

    #controls {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    #nav-controls {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      flex-direction: column; /* Stack buttons vertically */
      align-items: flex-start; /* Align buttons to the left */
      gap: 10px; /* Reduced gap for vertical spacing */
    }

    #balance {
      margin-right: 10px;
    }

    /* Style for social media icons */
    .social-links {
      display: flex;
      gap: 20px; /* Space between icons */
      margin-bottom: 20px; /* Space between icons and status div */
    }

    .social-icon {
      width: 48px; /* Increased base size for all icons */
      height: 48px;
      transition: transform 0.3s ease, opacity 0.3s ease; /* Smooth hover animation */
    }

    .social-icon.jupiter-icon {
      width: 57.6px; /* 20% larger than 48px */
      height: 57.6px;
    }

    .social-icon:hover {
      opacity: 0.8;
      transform: scale(1.1); /* Scale up on hover */
    }

    /* Style for donation text */
    .donation-text {
      position: fixed;
      bottom: 20px;
      width: 100%;
      text-align: center;
      font-size: 14px;
      color: #ccc;
      font-family: Arial, sans-serif;
    }

    .copyable {
      cursor: pointer;
      text-decoration: underline;
    }

    .copyable:hover {
      color: #e0e0e0;
    }

    /* Style for tagline */
    .tagline {
      font-size: 18px;
      color: #ccc;
      margin-bottom: 20px;
      min-height: 24px; /* Prevent layout shift */
    }
  </style>
</head>
<body>
  <div id="nav-controls">
    <button id="home" class="nav-button">Solmemetics</button>
    <button id="whitepaper" class="nav-button">Whitepaper</button>
  </div>
  <div id="controls">
    <div id="balance">Balance: 0 SMM</div>
    <button id="connect" class="connect-button">Connect</button>
  </div>
  <div class="content">
    <img src="your-image.png" alt="Coming Soon" />
    <div class="tagline" id="tagline"></div>
    <div class="social-links">
      <a href="https://t.me/solmemeticsTG" target="_blank" title="Join our Telegram">
        <img src="telegram.png" alt="Telegram" class="social-icon" />
      </a>
      <a href="https://jup.ag/tokens/BbDK2SdFKstCuCjF152jWaRVmJMV7hHUW4xYvdMbjups" target="_blank" title="Trade on Jupiter">
        <img src="jupiter.png" alt="Jupiter" class="social-icon jupiter-icon" />
      </a>
      <a href="https://x.com/solmemetics" target="_blank" title="Follow us on Twitter">
        <img src="twitter.png" alt="Twitter" class="social-icon" />
      </a>
    </div>
    <div id="status"></div>
  </div>
  <div class="donation-text">
    Help fund the project by donating Solana/USDC to <span id="donation-address" class="copyable">solmemetics.sol</span>
  </div>

  <script src="https://unpkg.com/@solana/web3.js@1.95.3/lib/index.iife.min.js"></script>

  <script>
    // SMM token mint address
    const TOKEN_MINT = new solanaWeb3.PublicKey("BbDK2SdFKstCuCjF152jWaRVmJMV7hHUW4xYvdMbjups");
    const TOTAL_SUPPLY = 100000000; // 100 million tokens
    const ONE_PERCENT = TOTAL_SUPPLY * 0.01; // 1% of total supply

    const connectBtn = document.getElementById("connect");
    const statusDiv = document.getElementById("status");
    const balanceDiv = document.getElementById("balance");
    const homeBtn = document.getElementById("home");
    const whitepaperBtn = document.getElementById("whitepaper");
    const donationAddress = document.getElementById("donation-address");
    const taglineDiv = document.getElementById("tagline");

    // Navigation button functionality
    homeBtn.addEventListener("click", () => {
      window.location.href = "index.html"; // Assuming this is the home page
    });

    whitepaperBtn.addEventListener("click", () => {
      window.location.href = "whitepaper.html";
    });

    // Copy-to-clipboard for donation address
    donationAddress.addEventListener("click", () => {
      navigator.clipboard.writeText("solmemetics.sol").then(() => {
        const originalText = donationAddress.textContent;
        donationAddress.textContent = "Copied!";
        setTimeout(() => {
          donationAddress.textContent = originalText;
        }, 2000);
      }).catch(err => {
        console.error("Copy failed:", err);
        donationAddress.textContent = "Copy failed!";
        setTimeout(() => {
          donationAddress.textContent = "solmemetics.sol";
        }, 2000);
      });
    });

    // Rotating tagline
    const taglines = [
      "Empowering the future of memes on Solana",
      "Join the Solmemetics revolution!",
      "Your gateway to meme-driven crypto"
    ];
    let taglineIndex = 0;

    function updateTagline() {
      taglineDiv.textContent = taglines[taglineIndex];
      taglineIndex = (taglineIndex + 1) % taglines.length;
    }
    updateTagline();
    setInterval(updateTagline, 5000); // Change every 5 seconds

    async function checkPhantomAndConnect() {
      if (!window.solana || !window.solana.isPhantom) {
        statusDiv.textContent = "Phantom Wallet not found. Please install Phantom.";
        window.open("https://phantom.app/", "_blank");
        return;
      }

      try {
        const provider = window.solana;
        const resp = await provider.connect();
        const publicKey = resp.publicKey;
        statusDiv.textContent = `Connected: ${publicKey.toBase58().slice(0, 6)}...`;

        const connection = new solanaWeb3.Connection(
          "https://silent-fluent-diamond.solana-mainnet.quiknode.pro/bdf6a6133f8736f5bf9097f4628841fe18b60bcc",
          { commitment: "confirmed", disableRetryOnRateLimit: false }
        );

        try {
          new solanaWeb3.PublicKey(TOKEN_MINT);
        } catch (formatError) {
          console.error("Invalid mint address format:", formatError);
          statusDiv.textContent = "Error: SMM token mint address is malformed.";
          return;
        }

        statusDiv.textContent += " Validating SMM token mint...";
        try {
          const mintInfo = await connection.getParsedAccountInfo(TOKEN_MINT);
          if (!mintInfo.value) {
            statusDiv.textContent = "Error: SMM token mint does not exist on Mainnet.";
            console.error("Mint not found:", TOKEN_MINT.toBase58());
            return;
          }
          if (mintInfo.value.data.program !== "spl-token") {
            statusDiv.textContent = "Error: Address is not a valid SPL token mint for SMM.";
            console.error("Invalid token mint program:", TOKEN_MINT.toBase58());
            return;
          }
        } catch (mintError) {
          console.error("Mint validation error:", mintError);
          if (mintError.message.includes("403")) {
            statusDiv.textContent = "Error: RPC access forbidden (403). Please try again or use a different RPC.";
          } else if (mintError.message.includes("rate limit")) {
            statusDiv.textContent = "Error: Solana RPC rate limit exceeded. Try again later.";
          } else if (mintError.message.includes("network")) {
            statusDiv.textContent = "Error: Network issue with Solana RPC.";
          } else {
            statusDiv.textContent = "Error: Failed to validate SMM token mint.";
          }
          return;
        }

        statusDiv.textContent += " Checking SMM token balance...";
        const tokenAccounts = await connection.getParsedTokenAccountsByOwner(
          publicKey,
          {
            mint: TOKEN_MINT,
            programId: new solanaWeb3.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),
          }
        );

        let tokenBalance = 0;
        for (const { account } of tokenAccounts.value) {
          const info = account.data.parsed.info;
          if (info.mint === TOKEN_MINT.toBase58()) {
            tokenBalance = parseFloat(info.tokenAmount.uiAmount);
            break;
          }
        }

        // Display balance with up to 9 decimals, trimming trailing zeros
        const balanceString = tokenBalance.toString();
        const [integerPart, decimalPart] = balanceString.split('.');
        let displayBalance = integerPart;
        if (decimalPart) {
          const trimmedDecimals = decimalPart.replace(/0+$/, '').slice(0, 9);
          if (trimmedDecimals) {
            displayBalance += '.' + trimmedDecimals;
          }
        }
        balanceDiv.textContent = `Balance: ${displayBalance || 0} SMM`;

        statusDiv.textContent = getCompliment(tokenBalance);

        function getCompliment(balance) {
          if (balance < 1 && balance > 0) {
            return "Thats not even one token, are you sure you have the right wallet?";
          } else if (balance === 1) {
            return "Hmm, just 1 SMM? Curious, why so few?";
          } else if (balance > 1 && balance <= 10) {
            const compliments = [
              "Nice start with your SMM! Maybe take it slow in crypto?",
              "A few SMM - great taste, but crypto might not be your full-time gig yet!",
              "You’ve got some SMM! Perhaps crypto’s a gentle hobby for now?"
            ];
            return compliments[Math.floor(Math.random() * compliments.length)];
          } else if (balance > 10 && balance <= 100) {
            const compliments = [
              "Wow, over 10 SMM! You’re doing well - maybe crypto isn’t your calling, but it’s fun!",
              "More than 10 SMM? Impressive, though you might enjoy it more outside crypto!",
              "Over 10 SMM - nice stash! Crypto might be a sideline for you, no pressure!"
            ];
            return compliments[Math.floor(Math.random() * compliments.length)];
          } else if (balance > 100 && balance <= ONE_PERCENT) {
            const compliments = [
              "Over 100 SMM? That’s cool! Have you thought about grabbing more?",
              "Nice, more than 100 SMM! Ever considered adding to your stack?",
              "100+ SMM - awesome! Maybe pick up a few more when you can?"
            ];
            return compliments[Math.floor(Math.random() * compliments.length)];
          } else if (balance > ONE_PERCENT) {
            return "With over 1% of SMM (1 million+), you’re a powerhouse! You could shape the project’s direction - exciting times ahead!";
          } else if (balance === 0) {
            return "No tokens found in this wallet, this definitely can't be the right wallet";
          }
          return "Error determining SMM balance.";
        }

        // Change button to disconnect and enable disconnect functionality
        connectBtn.textContent = "Disconnect";
        connectBtn.onclick = async () => {
          try {
            await provider.disconnect();
            connectBtn.textContent = "Connect";
            balanceDiv.textContent = "Balance: 0 SMM";
            statusDiv.textContent = "";
            connectBtn.onclick = checkPhantomAndConnect;
          } catch (err) {
            console.error("Disconnect error:", err);
            statusDiv.textContent = "Error disconnecting from Phantom wallet.";
          }
        };
      } catch (err) {
        console.error("Error during connection or query:", err);
        if (err.code === 4001) {
          statusDiv.textContent = "Connection rejected by user.";
        } else if (err.message.includes("403")) {
          statusDiv.textContent = "Error: RPC access forbidden (403). Please try again or use a different RPC.";
        } else if (err.message.includes("rate limit")) {
          statusDiv.textContent = "Error: Solana RPC rate limit exceeded. Try again later.";
        } else if (err.message.includes("network")) {
          statusDiv.textContent = "Error: Network issue with Solana RPC.";
        } else {
          statusDiv.textContent = "Error: Failed to fetch SMM token balance.";
        }
      }
    }

    connectBtn.addEventListener("click", checkPhantomAndConnect);

    window.addEventListener("load", async () => {
      if (window.solana && window.solana.isPhantom) {
        try {
          const provider = window.solana;
          if (provider.isConnected) {
            await checkPhantomAndConnect();
          }
        } catch (err) {
          console.error("Auto-connect error:", err);
        }
      }
    });
  </script>
</body>
</html>